<html>
<head>
    <title>Parkhaus</title>
    <link rel="stylesheet" href="css/styles.css">

    <!--Charts-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        /* Light mode */
        body {
            background-color: white;
            color: black;
        }
        
        /* Dark mode */
        .darkmode {
            background-color: black;
            color: white;
        }

        /* Text alignments*/
        h1 {
            text-align: left;
        }
        
        h2 {
            text-align: left;
        }

        h3 {
            text-align: left;
        }

        h4 {
            text-align: left;
        }
    </style>
</head>

<body>
<script type="text/javascript">
    if (window.location.search != '')
        var url = window.location.search;
    var parkplatzspaceCount = parseInt((url.replace('?anzahl=','')),10);
</script>



<h1>Parkhaus</h1>
<h2>Aktuelle Uhrzeit:</h2>
<div id="digitalclock" class="clock">Clock</div>
<script src="javascript/digitalclock.js"></script>
<br>
<br>

<!--Light Mode and Dark Mode-->
<button onclick="darkmode()">Toggle Dark/Light Mode</button>
<script>
    function darkmode() {
        var element = document.body;
        element.classList.toggle("darkmode");
    }
</script>


<h2>Öffnungszeiten:</h2>
<table id="openingHours">
	<thead>
		<tr>
			<th>Wochentag</th>
			<th>Von</th>
			<th>bis</th>
        </tr>
	</thead>
	<tbody>
		<tr>
			<td>Montag - Freitag</td>
			<td>06:00</td>
			<td>22:00</td>
		</tr>
		<tr>
			<td>Samstag</td>
			<td>08:00</td>
			<td>00:00</td>
		</tr>
		<tr>
			<td>Sonntag</td>
			<td>10:00</td>
			<td>20:00</td>
		</tr>
	</tbody>
</table>


<h2>Preise:</h2>
<table id="priceList">
	<thead>
		<tr>
			<th>Personengruppe</th>
			<th>Preis in Euro [€]</th>
            <th>Vergünstigung in Prozent [%]</th>
        </tr>
	</thead>
	<tbody>
		<tr>
			<td>Kein</td>
			<td>3,00</td>
            <td>00</td>
		</tr>
		<tr>
			<td>Familie</td>
			<td>2,70</td>
            <td>10</td>
		</tr>
		<tr>
			<td>Frau</td>
			<td>2,85</td>
            <td>05</td>
		</tr>
        <tr>
            <td>Person mit Behinderung</td>
            <td>2,10</td>
            <td>30</td>
        </tr>
        <tr>
            <td>Mitarbeiter</td>
            <td>2,40</td>
            <td>20</td>
        </tr>
	</tbody>
</table>


<canvas id="testChart" width="400" height="400"></canvas>
<script src="javascript/charts.js"></script>


<h4>Anzahl Parkpl&aumltze insgesamt:</h4>
<p id="anzahlParkplaetzeGesamt"></p>
<h4>Anzahl Freie Parkpl&aumltze:</h4>
<p id="anzahlFreieParkplaetze"></p>
<h4>Anzahl Besetzter Parkpl&aumltzen:</h4>
<p id="anzahlBesetztParkplaetze"></p>

<button onclick="CarsInList()">Neues Auto im Parkhaus</button>
<br>
<br>

<!--Icons-->
<script src="https://kit.fontawesome.com/a076d05399.js"></script>
<i class="fas fa-car" style="font-size:25px;color:red;"></i>


<form  id="Bezahlvorgang">
    <h1>Bezahlsystem</h1>
    <label for="Ticket-Nr.">Ticket-Nr.
        <select id="autosImParkhausbezahlen"></select>
    </label>


    <h3>Sondertarif?</h3>
    <input type="radio" id="keintarif" name="tarif" value="kein">
    <label for="keintarif">Kein</label>
    <input type="radio" id="familientarif" name="tarif" value="familie">
    <label for="familientarif">Familie</label>
    <input type="radio" id="frauentarif" name="tarif" value="frau">
    <label for="frauentarif">Frau</label>
    <input type="radio" id="behindertentarif" name="tarif" value="behindert">
    <label for="behindertentarif">Person mit Behinderung</label>
    <input type="radio" id="mitarbeitertarif" name="tarif" value="mitarbeiter">
    <label for="mitarbeitertarif">Mitarbeiter</label>
    <br>
    <br>
    <button type="reset">Ausgew&aumlhlter Tarif widerrufen</button>
</form>

<button id="btnPay" onclick="pay()">Tarif bezahlen</button>
<br>
<br>



<script type="text/javascript">
    var i=0;
    var parkhausSize=0;
    parkhausSize=parseInt(parkplatzspaceCount.valueOf(),10);
    var pricePerHour=2.0;
    var carArray=[];
    var payedCarsArray=[];
    document.getElementById("anzahlFreieParkplaetze").innerText=""+parkhausSize-i+"";
    document.getElementById("anzahlParkplaetzeGesamt").innerText=""+parkhausSize+"";
    document.getElementById("anzahlBesetztParkplaetze").innerText = "" + i + "";

    function x() {
        if (parkhausSize > 0) {
            document.getElementById("anzahlFreieParkplaetze").innerText = "" + parkhausSize - i + "";
            document.getElementById("anzahlBesetztParkplaetze").innerText = "" + i + "";
        }
    }

    var payedCars=function (idd,datee,datenow,pricee,tariff) {
        this.id=idd;
        this.date=datee;
        this.leftParkhouse=datenow;
        this.price=pricee;
        this.tarif=tariff;
    }

    var Auto=function () {
        this.id=Math.random();
        this.date=new Date();
        function getId() {
            return this.id;
        }
    }

    function CarsInList() {
        if(i<parkhausSize) {

            i=i+1;
            x()
            a=new Auto();
            carArray.push(a);
            //in anzeige Liste eintragen
            var option = new Option('Autoid: '+a.id);
            var selectpayList= document.getElementById('autosImParkhausbezahlen');
            selectpayList.options[i-1]=option;

        }
        else if (i <= 0) {
            window.alert("Das Parkhaus ist leer.");
        }
        else
        {
            window.alert("Das Parkhaus ist voll.");
        }
    }

    function listeRefresh () {
        var selectElement = document.getElementById('autosImParkhausbezahlen');
        var kkkk;
        for(kkkk=0;kkkk<carArray.length;kkkk++){
            var option1 = new Option('Autoid: '+carArray[kkkk].id);
            selectElement.options[kkkk] = option1;
        }
    }

    function pay() {
        var newHelpArray = [];

        if (i == 0) {
            window.alert("Es ist noch kein Auto bzw. nicht mehr im Parkhaus.\nSie können noch kein Ticket bezahlen.");
        }
        else{
            i=i-1;
            var list=document.getElementById("autosImParkhausbezahlen");
            var strUser = list.options[list.selectedIndex].value;
            var splittet=strUser.split(": ");
            document.getElementById("anzahlBesetztParkplaetze").innerText=""+i+"";
            document.getElementById("anzahlFreieParkplaetze").innerText=""+parkhausSize-i+"";
            var kkk;

            for (kkk = 0; kkk < carArray.length; kkk++){
                if (splittet[1] == carArray[kkk].id) {
                    var datenow = new Date();
                    var millisecondsSubDate = (datenow - carArray[kkk].date);
                    var secondsSubDates = millisecondsSubDate / 1000;
                    var priceCar = secondsSubDates * pricePerHour;
                    var tarif;
                    document.getElementById('keintarif').checked = true;

                    if (document.getElementById('keintarif').checked) {
                        tarif = 'keintariif';
                    }
                    else if (document.getElementById('familientarif').checked) {
                        tarif = 'familientarif';
                        var familientarif=0.10;
                        priceCar = (priceCar) - (priceCar * familientarif);
                    }
                    else if (document.getElementById('frauentarif').checked) {
                        tarif = 'frauentarif';
                        var frauentarif = 0.05;
                        priceCar = (priceCar) - (priceCar * frauentarif);
                    }
                    else if (document.getElementById('behindertentarif').checked) {
                        tarif = 'behindertentarif';
                        var behindertentarif=0.30;
                        priceCar=(priceCar)-(priceCar*behindertentarif);
                    }
                    else if (document.getElementById('mitarbeitertarif').checked) {
                        tarif = 'mitarbeitertarif';
                        var mitarbeitertarif = 0.20;
                        priceCar = (priceCar) - (priceCar * mitarbeitertarif);
                    }
                    b = payedCars(carArray[kkk].id, carArray[kkk].date, datenow, priceCar, tarif);
                    payedCarsArray.push(b);
                } else {
                    newHelpArray.push(carArray[kkk]);
                }
            }

            var x;
            var list = document.getElementById("autosImParkhausbezahlen");

            for(x=0;x<carArray.length;x++){
                list.options[x]=null;
            }

            carArray=newHelpArray;
            listeRefresh();
        }
    }
</script>



<script>
    // Klasse für Kunden erstellen
    class Kunde{
        constructor(id, name) {
            this.id = id;
            this.name = name;
        }

        get name() {
            return this.name;
        }
    }

    // Klasse für Familie
    class Famile extends Kunde{
        constructor(id, name, anzahlPersonen) {
            super(id, name);
            this.anzahlPersonen = anzahlPersonen;
        }
    }

    // Klasse für Mitarbeiter des Parkhauses
    class Mitarbeiter{
        constructor(id, name, gehalt, arbeitsbezeichnung) {
            this.id = id;
            this.name = name;
            this.gehalt = gehalt;
            this.arbeitsbezeichnung = arbeitsbezeichnung;
        }

        get name() {
            return this.name;
        }

        get gehalt() {
            return this.gehalt;
        }

        get arbeitsbezeichnung() {
            return this.arbeitsbezeichnung;
        }
    }

    // Klasse der Manager
    class Manager extends Mitarbeiter{
        constructor(id, name, gehalt, arbeitsbezeichnung) {
            super(id, name, gehalt, arbeitsbezeichnung);
        }
    }

    // Klasse der Parkhausbetreiber
    class Parkhausbetreiber extends Mitarbeiter{
        constructor(id, name, gehalt, arbeitsbezeichnung) {
            super(id, name, gehalt, arbeitsbezeichnung);
        }
    }

    // Klasse der Schrankenwärter
    class Schrankenwärter extends Mitarbeiter{
        constructor(id, name, gehalt, arbeitsbezeichnung) {
            super(id, name, gehalt, arbeitsbezeichnung);
        }
    }

    // Klasse der Einweiser
    class Einweiser extends Mitarbeiter{
        constructor(id, name, gehalt, arbeitsbezeichnung) {
            super(id, name, gehalt, arbeitsbezeichnung);
        }
    }

    // Klasse der Investoren
    class Investor extends Kunde{
        constructor(id, name, gehalt, arbeitsbezeichnung) {
            super(id, name, gehalt, arbeitsbezeichnung);
        }
    }

    // Funktion, um ein Objekt in JSON-Format zu überführen
    function createJSON(Cars) {
        var string = JSON.stringify(Cars);
        console.log(string);
    }
</script>

</body>
</html>
