
<html>
<head>
    <title>Parkhaus</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>




<script type="text/javascript">
    if (window.location.search != '')
        var url = window.location.search;
    var parkspacesCount = parseInt((url.replace('?count=','')),10);
</script>
<h1>Parkhaus</h1>
<h2>Uhrzeit:</h2>
<div id="digitalclock" class="clock">Clock</div>
<script src="javascript/digitalclock.js"></script>
<h2>Autos im Parkhaus:</h2>
<h4>Parkplätze ins:   </h4>
<h4>Freie Parkplätze: </h4>
<p id="bereich1">
</p>

<button onclick="myFun()">Neues Auto im Parkhaus</button>
<select id="autosImParkhaus"></select>
<input type="submit" value="Auto aus der Liste auswählen und dann hier auf pay klicken" onclick="pay()">
<form  id="Bezahlvorgang">
        <h1>pay</h1>
       <label for="Ticket-Nr.">Ticket-Nr.
           <input id="Ticket-Nr." name="Ticket-Nr.">
       </label>
        <h3>Sondertarif</h3>
        <input type="radio" id="keintarif" name="tarif" value="kein">
        <label for="keintarif">Kein</label>
       <input type="radio" id="familientarif" name="tarif" value="familie">
       <label for="familientarif">Familie</label>
       <input type="radio" id="Employeetarif" name="tarif" value="Employee">
       <label for="Employeetarif">Employee</label>
       <input type="radio" id="behindertentarif" name="tarif" value="behindert">
       <label for="behindertentarif">Behindert</label>
       <input type="radio" id="frauentarif" name="tarif" value="frau">
       <label for="frauentarif">Frau</label>
    </br>
    </br>
        <button type="submit">Bestätigen</button>
        <button type="reset">Widerrufen</button>
    </form>

<script type="text/javascript">
    var i=0;
    var parkhouseSize=0;
    parkhouseSize=parseInt(parkspacesCount.valueOf(),10);
    var pricePerHour=2.0;
    var carArray=[];
    var carsToDisplay=[];
    var payedCarsArray=[];
    function x(){if(parkhouseSize>0){document.getElementsByTagName('p')[0].innerText=""+parkhouseSize-i+"";}}
    document.getElementById("bereich1").innerText=""+parkhouseSize-i+"";
    var payedCars=function (idd,datee) {
        this.id=idd;
        this.date=datee;
        this.leftParkhouse=new Date();
        this.price;
    }
    var Auto=function () {
        this.id=Math.random();
        this.date=new Date();
        function Getid() {
            return this.id;
        }
    }

    function myFun() {
        if(i<parkhouseSize) {

            i=i+1;
            x();
            a=new Auto();
            carArray.push(a);
            //in anzeige list eintragen
            var selectedElement = document.getElementById('autosImParkhaus');
            var option = new Option('AutoId: '+a.id);
         selectedElement.options[i] = option;


        }
        else
        {
            window.alert("Das Parkhaus ist voll.");
        }



    }
    function listRefresh () {
        var selectedElement = document.getElementById('autosImParkhaus');

        var kkkk;
        for(kkkk=0;kkkk<carArray.length;kkkk++){
            var option1 = new Option('AutoId: '+carArray[kkkk].id);
         selectedElement.options[kkkk] = option1;}
    }
    </script>
<script>

// Class for Customers
class Customer{
constructor(id,name){
    this.id = id;
    this.name = name;
   
}

get name(){
    return this.name;
}

}

// Class for Family
class Family extends Customer{

constructor(id,name,peopleCount){
    super(id,name);
    this.peopleCount = peopleCount;
}


}

// Class Employee of parking garage
class Employee{

constructor(id,name,payment,workingDescription){
    this.id = id;
    this.name = name;
    this.payment = payment;
    this.workingDescription = workingDescription;
}

get name(){
    return this.name;
}

get payment(){
    return this.payment;
}

get workingDescription(){
    return this.workingDescription;
}


}

// Class Manager of parking garage
class Manager extends Employee{
    constructor(id,name,payment,workingDescription){
        super(id,name,payment,workingDescription);
    }
}

// Class Boss of parking garage
class PgBoss extends Employee{
    constructor(id,name,payment,workingDescription){
        super(id,name,payment,workingDescription);
    }
}

// Class Crossing Keeper of parking garage
class crossingKeeper extends Employee{
    constructor(id,name,payment,workingDescription){
        super(id,name,payment,workingDescription);
    }
}

// Class PositionAdapter
class PositionAdapter extends Employee{
    constructor(id,name,payment,workingDescription){
        super(id,name,payment,workingDescription);
    }
}

// Class Investor
class Investor extends Customer{   
    constructor(id,name,payment,workingDescription){
        super(id,name,payment,workingDescription);
    }
}



// Funktion, um ein Objekt in JSON-Format zu überführen
    function createJSON(Cars){
       
       var string = JSON.stringify(Cars);
       console.log(string);


    }

    function pay() {

        var helpArray=[];
        if(i==0){
            window.alert("Es ist noch kein Auto bzw. das Auto ist nicht mehr im Parkhaus. Sie können noch kein Ticket pay");
        }
        else{
            var list=document.getElementById("autosImParkhaus");
            var strUser = list.options[list.selectedIndex].value;
            var splittet=strUser.split(": ");
            var kkk;
            for(kkk=0;kkk<carArray.length;kkk++){
            if(splittet[1]==carArray[kkk].id){
                b=payedCars(carArray[kkk].id,carArray[kkk].date);
                payedCarsArray.push(b);

            }else{
                helpArray.push(carArray[kkk]);
            }}
            var x;
            var list=document.getElementById("autosImParkhaus");
            for(x=0;x<carArray.length;x++){
                list.options[x]=null;
            }
            carArray=helpArray;
            console.log(carArray);
            createJSON(carArray);
            listRefresh();
        }
    }

</script>
</body>
</html>
